<div class="profile" style="margin-top: 10rem; flex-direction: column; align-items: center;">
  {{- with site.Params.profileMode}}
  
  <div class="profile_inner" style="border: 2px solid var(--secondary); padding: 1rem; border-radius: 8px;">

    <!-- FLEX COLUMN: stack row, then buttons -->
    <div style="display: flex; flex-direction: column; align-items: center;">

      <!-- FLEX ROW: the two columns -->
      <div style="display: flex; align-items: flex-start; gap: 2rem; width: 100%; justify-content: center;">

        <!-- Left Column: Image -->
        <div style="display: flex; flex-direction: column; align-items: flex-start;">
          {{- if .imageUrl -}}
            {{- $img := "" }}
            {{- if not (urls.Parse .imageUrl).IsAbs }}
              {{- $img = resources.Get .imageUrl }}
            {{- end }}
            {{- if $img }}
              <img draggable="false" src="{{ $img.Permalink }}"
                   alt="{{ .imageTitle | default "profile image" }}" title="{{ .imageTitle }}"
                   height="{{ .imageHeight | default 150 }}" width="{{ .imageWidth | default 150 }}" />
            {{- else }}
              <img draggable="false" src="{{ .imageUrl | absURL }}" 
                   alt="{{ .imageTitle | default "profile image" }}" title="{{ .imageTitle }}"
                   height="{{ .imageHeight | default 150 }}" width="{{ .imageWidth | default 150 }}" />
            {{- end }}
          {{- end }}
        </div>

        <!-- Right Column: Titles + Social Icons -->
        <div style="display: flex; flex-direction: column; justify-content: center;">
          <h1 style="margin: 0;">{{ .title | default site.Title | markdownify }}</h1>
          <h4 style="margin-top: 0.75rem">{{ .subtitle  | markdownify }}</h4>
          <h5 style="margin-top: 0.25rem">{{ .subtitleInst | markdownify }}</h5>
          <h4 style="margin-top: 0.75rem">{{ .subsubtitle | markdownify }}</h4>
          <h5 style="margin-top: 0.25rem; margin-bottom: .75rem" >{{ .subsubtitleInst | markdownify }}</h5>
          <!-- <span style="font-size: 1.2rem; color: var(--content); margin-bottom: 0.75rem; margin-top: 0.75rem; font-weight: 500;">
            {{ .subtitle | markdownify }}<br>{{ .subsubtitle | markdownify }}
          </span> -->
      
          <!-- Social Icons -->
          {{- partial "social_icons.html" -}}
        </div>
      </div> <!-- end row -->

      <!-- Division line -->
      <hr style="width: 85%; margin: 1.5rem auto 1.rem auto; border: 0; border-top: 2px solid var(--secondary)">

      <!-- BUTTONS: centered below both columns -->
      <div style="display: flex; justify-content: flex-end; width: 100%; margin-top: 1rem;">
        <!-- Dark Mode Toggle Button -->        
      </div>
      {{- with .buttons }}
      <div class="buttons" style=" display: flex; justify-content: center; gap: .1rem; flex-wrap: wrap;">
        {{- range . }}
        <a class="button" href="{{ trim .url " " }}" rel="noopener" title="{{ .name }}">
          <span class="button-inner">
            {{ .name }}
            {{- if (findRE "://" .url) }}&nbsp;
            <svg fill="none" shape-rendering="geometricPrecision" stroke="currentColor" stroke-linecap="round"
              stroke-linejoin="round" stroke-width="2.5" viewBox="0 0 24 24" height="14" width="4">
              <path d="M18 13v6a2 2 0 01-2 2H5a2 2 0 01-2-2V8a2 2 0 01-2-2h6"></path>
              <path d="M15 3h6v6"></path>
              <path d="M10 14L21 3"></path>
            </svg>
            {{- end }}
          </span>
        </a>
        {{- end }}

          <button id="theme-toggle" style="align-items: right; flow">
                  <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 20 24"
                        fill="none" stroke="black" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24"
                        fill="none" stroke="white" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                </svg>
          </button>
      </div>
      {{- end }}

    </div> <!-- flex column -->
  </div>
  {{- end}}
</div>